<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMBA Dashboard - Overview</title>
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <!-- DataTables -->
  <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
    rel="stylesheet">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="src/css/main.css">
  <style>
    /* Add any additional custom styles here */
  </style>
</head>

<body>
  <div class="wrapper">
    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="logo">
        <span class="logo-text">SMBA</span>
      </div>

      <div class="sidebar-content">
      <div class="nav-section">
          <div class="nav-header">
            Menu
          </div>
          <a class="nav-link active" href="index.html">
              <i class="bi bi-grid"></i>
            <div class="nav-content">
              <span class="nav-title">Overview</span>
              <span class="nav-subtitle">Dashboard & Analytics</span>
            </div>
          </a>
          <a class="nav-link" href="shop.html">
            <i class="bi bi-shop"></i>
            <div class="nav-content">
              <span class="nav-title">Shop Status</span>
              <span class="nav-subtitle">Monitor Shop Performance</span>
            </div>
          </a>
          <a class="nav-link" href="invoiceCreation.html">
            <i class="bi bi-file-text"></i>
            <div class="nav-content">
              <span class="nav-title">Invoice Creation</span>
              <span class="nav-subtitle">Create & Manage Invoices</span>
            </div>
          </a>
        </div>
      </div>

      <a href="#" class="logout-button">
        <i class="bi bi-box-arrow-right"></i>
        <span>Sign Out</span>
      </a>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="d-flex justify-content-between align-items-center w-100">
          <div class="d-flex align-items-center gap-4">
            <button class="menu-toggle header-icon d-lg-none">
              <i class="bi bi-list"></i>
            </button>
            <div class="page-info">
              <h1 class="page-title mb-1" id="pageTitle">Overview</h1>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item">Dashboard</li>
                  <li class="breadcrumb-item active" id="currentPage">Overview</li>
                </ol>
              </nav>
            </div>
          </div>

          <div class="header-actions">
            <div class="action-group">
              <button class="header-icon" data-bs-toggle="tooltip" data-bs-title="Refresh">
                <i class="bi bi-arrow-repeat"></i>
                <div class="ripple"></div>
              </button>
              <button class="header-icon" data-bs-toggle="tooltip" data-bs-title="Notifications">
                <i class="bi bi-bell"></i>
                <span class="badge">3</span>
                <div class="ripple"></div>
              </button>
              <button class="header-icon" data-bs-toggle="tooltip" data-bs-title="Messages">
                <i class="bi bi-chat"></i>
                <span class="badge">5</span>
                <div class="ripple"></div>
            </button>
            </div>
            <div class="profile-wrapper">
              <button class="profile-trigger" data-bs-toggle="dropdown">
                <div class="profile-info">
                  <div class="profile-avatar">
                    <span class="avatar-text">JD</span>
                    <span class="status-dot"></span>
                  </div>
                  <div class="profile-details d-none d-sm-flex">
                    <span class="profile-name">Jane Doe</span>
                    <span class="profile-role">Administrator</span>
                  </div>
                </div>
                <div class="profile-action">
                  <i class="bi bi-chevron-down"></i>
                </div>
            </button>
              <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a></li>
                <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item text-danger" href="#"><i class="bi bi-box-arrow-right me-2"></i>Sign Out</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </header>

      <!-- Dashboard Content -->
      <div class="content">
        <!-- Summary Section -->
        <div class="summary-section">
          <div class="summary-header">
            <h2 class="summary-title">Performance Overview</h2>
            <p class="summary-subtitle">Real-time metrics and key performance indicators</p>
          </div>
          
          <div class="summary-cards">
            <!-- Active Shops Card -->
            <div class="summary-card primary">
              <div class="summary-header">
                <div class="summary-title">
                  <i class="bi bi-shop"></i>
                  Active Shops
                </div>
                <div class="summary-trend positive">
                  <i class="bi bi-arrow-up-right"></i>
                  8.2%
                </div>
              </div>
              <div class="summary-body">
                <div class="summary-main">42</div>
                <div class="summary-stats">
                  <div class="summary-stat">
                    <span class="summary-label">Operational</span>
                    <span class="summary-value">35</span>
                  </div>
                  <div class="summary-stat">
                    <span class="summary-label">Maintenance</span>
                    <span class="summary-value">7</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Average TAT Card -->
            <div class="summary-card warning">
              <div class="summary-header">
                <div class="summary-title">
                  <i class="bi bi-clock-history"></i>
                  Avg. TAT
                </div>
                <div class="summary-trend negative">
                  <i class="bi bi-arrow-down-right"></i>
                  2.5%
                </div>
              </div>
              <div class="summary-body">
                <div class="summary-main">3.5 days</div>
                <div class="summary-stats">
                  <div class="summary-stat">
                    <span class="summary-label">Min TAT</span>
                    <span class="summary-value">1.8d</span>
                  </div>
                  <div class="summary-stat">
                    <span class="summary-label">Max TAT</span>
                    <span class="summary-value">4.2d</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- On-Time Performance Card -->
            <div class="summary-card success">
              <div class="summary-header">
                <div class="summary-title">
                  <i class="bi bi-check-circle"></i>
                  On-Time
                </div>
                <div class="summary-trend positive">
                  <i class="bi bi-arrow-up-right"></i>
                  15.8%
                </div>
              </div>
              <div class="summary-body">
                <div class="summary-main">94.5%</div>
                <div class="summary-stats">
                  <div class="summary-stat">
                    <span class="summary-label">Last Week</span>
                    <span class="summary-value">92%</span>
                  </div>
                  <div class="summary-stat">
                    <span class="summary-label">Target</span>
                    <span class="summary-value">95%</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Delayed Jobs Card -->
            <div class="summary-card danger">
              <div class="summary-header">
                <div class="summary-title">
                  <i class="bi bi-exclamation-circle"></i>
                  Delayed
                </div>
                <div class="summary-trend negative">
                  <i class="bi bi-arrow-up-right"></i>
                  12.5%
                </div>
              </div>
              <div class="summary-body">
                <div class="summary-main">8</div>
                <div class="summary-stats">
                  <div class="summary-stat">
                    <span class="summary-label">Critical</span>
                    <span class="summary-value">3</span>
                  </div>
                  <div class="summary-stat">
                    <span class="summary-label">Avg. Delay</span>
                    <span class="summary-value">1.8d</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      
        <!-- Billing Performance Section -->
        <div class="row g-3 mb-1">
          <!-- Timeliness Chart -->
          <div class="col-lg-8">
            <div class="chart-container mb-3">
              <div class="chart-header mb-2 d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-3">
                  <h2 class="chart-title d-flex align-items-center m-0">
                    <i class="bi bi-graph-up me-2"></i>
                    Timeliness
                  </h2>
                  <div class="chart-legend d-flex border-start ps-3">
                    <div class="legend-item d-flex align-items-center me-3">
                      <span class="legend-dot d-inline-block me-1"
                        style="width:6px;height:6px;border-radius:50%;background:var(--primary-color)"></span>
                      <span class="small">Monthly</span>
                    </div>
                    <div class="legend-item d-flex align-items-center">
                      <span class="legend-dot d-inline-block me-1"
                        style="width:6px;height:6px;border-radius:50%;background:var(--success-color)"></span>
                      <span class="small">Trend</span>
                    </div>
                  </div>
                </div>
                <div class="chart-actions d-flex gap-1">
                  <button class="chart-action-btn" title="Download">
                    <i class="bi bi-download"></i>
                  </button>
                  <button class="chart-action-btn" title="Refresh">
                    <i class="bi bi-arrow-repeat"></i>
                  </button>
                </div>
              </div>

              <div class="row g-2 mb-2">
                <div class="col-4">
                  <div class="bg-light rounded p-2">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <span class="small text-muted">Average</span>
                      <span class="badge bg-success-subtle text-success">+15.3%</span>
                    </div>
                    <div class="h5 mb-0">48.6</div>
                  </div>
                </div>
                <div class="col-4">
                  <div class="bg-light rounded p-2">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <span class="small text-muted">Peak</span>
                      <span class="badge bg-primary-subtle text-primary">Jun'23</span>
                    </div>
                    <div class="h5 mb-0">113</div>
              </div>
                </div>
                <div class="col-4">
                  <div class="bg-light rounded p-2">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <span class="small text-muted">Latest</span>
                      <span class="badge bg-danger-subtle text-danger">-33.3%</span>
                    </div>
                    <div class="h5 mb-0">50</div>
                  </div>
            </div>
          </div>

              <div class="chart-wrapper" style="height: 180px;">
                <canvas id="timelinessOverviewChart"></canvas>
              </div>

              <div class="chart-footer mt-2 pt-2 border-top">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="chart-insight small text-muted">
                    <i class="bi bi-info-circle"></i>
                    <span>Showing upward trend in recent months</span>
                  </div>
                  <div class="small">
                    <a href="billing.html" class="text-decoration-none">View Details <i
                        class="bi bi-arrow-right"></i></a>
                  </div>
                </div>
              </div>
            </div>
                </div>

          <!-- Delay Analysis -->
          <div class="col-lg-4">
            <div class="chart-container mb-3">
              <div class="chart-header mb-2 d-flex justify-content-between align-items-center">
                <h2 class="chart-title d-flex align-items-center m-0">
                  <i class="bi bi-pie-chart-fill me-2"></i>
                  Delay Analysis
                </h2>
                <div class="chart-actions d-flex gap-1">
                  <button class="chart-action-btn" title="Download">
                    <i class="bi bi-download"></i>
                  </button>
                  <button class="chart-action-btn" title="Refresh">
                    <i class="bi bi-arrow-repeat"></i>
                  </button>
                </div>
              </div>

              <div class="row g-2 mb-2">
                <div class="col-6">
                  <div class="bg-light rounded p-2">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <span class="small text-muted">Total Delays</span>
                      <span class="badge bg-danger-subtle text-danger">+15.2%</span>
                    </div>
                    <div class="h5 mb-0">110</div>
                  </div>
                </div>
                <div class="col-6">
                  <div class="bg-light rounded p-2">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <span class="small text-muted">Most Common</span>
                      <span class="badge bg-primary-subtle text-primary">41%</span>
                    </div>
                    <div class="h5 mb-0">Capacity</div>
                  </div>
                </div>
              </div>

              <div class="row g-2">
                <div class="col-lg-6">
                  <div class="chart-wrapper" style="height: 180px;">
                    <canvas id="delayReasonsOverviewChart"></canvas>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="delay-stats bg-light rounded">
                    <div class="delay-item d-flex align-items-center p-2 border-bottom">
                      <div class="delay-color me-2" style="width:8px;height:8px;border-radius:50%;background:#4f46e5">
                      </div>
                      <div class="delay-name flex-grow-1 small">Capacity</div>
                      <div class="delay-value small fw-medium">45</div>
                      <div class="delay-percent ms-2 small text-muted">41%</div>
                    </div>
                    <div class="delay-item d-flex align-items-center p-2 border-bottom">
                      <div class="delay-color me-2" style="width:8px;height:8px;border-radius:50%;background:#10b981">
                      </div>
                      <div class="delay-name flex-grow-1 small">Customer</div>
                      <div class="delay-value small fw-medium">30</div>
                      <div class="delay-percent ms-2 small text-muted">27%</div>
                    </div>
                    <div class="delay-item d-flex align-items-center p-2 border-bottom">
                      <div class="delay-color me-2" style="width:8px;height:8px;border-radius:50%;background:#f59e0b">
                      </div>
                      <div class="delay-name flex-grow-1 small">Volume</div>
                      <div class="delay-value small fw-medium">14</div>
                      <div class="delay-percent ms-2 small text-muted">13%</div>
                    </div>
                    <div class="delay-item d-flex align-items-center p-2">
                      <div class="delay-color me-2" style="width:8px;height:8px;border-radius:50%;background:#6b7280">
                      </div>
                      <div class="delay-name flex-grow-1 small">Other</div>
                      <div class="delay-value small fw-medium">21</div>
                      <div class="delay-percent ms-2 small text-muted">19%</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="chart-footer mt-2 pt-2 border-top">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="chart-insight small text-muted">
                    <i class="bi bi-info-circle"></i>
                    <span>Resource capacity is the primary delay factor</span>
                  </div>
                  <div class="small">
                    <a href="billing.html" class="text-decoration-none">View Details <i
                        class="bi bi-arrow-right"></i></a>
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Shop Status Table Section -->
        <div class="table-section mb-4">
          <div class="table-header mb-3">
            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
              <div class="d-flex align-items-center gap-3">
                <h2 class="table-title m-0">Shop Status Overview</h2>
                <div class="badge bg-primary-subtle text-primary">27 Total Shops</div>
              </div>
              <div class="d-flex align-items-center gap-3">
                <div class="input-group input-group-sm" style="width: 200px;">
                  <span class="input-group-text bg-light border-end-0">
                    <i class="bi bi-search"></i>
                  </span>
                  <input type="text" class="form-control border-start-0" id="shopSearch" placeholder="Search shops...">
                </div>
                <div class="queue-tabs">
                  <div class="queue-tab active" data-queue="my">
                    <i class="bi bi-person"></i>
                    My Queue
                  </div>
                  <div class="queue-tab" data-queue="overall">
                    <i class="bi bi-people"></i>
                    Overall Queue
                  </div>
                </div>
              </div>
            </div>
            <div class="table-filters mt-2 d-flex gap-2">
              <div class="btn-group btn-group-sm">
                <button type="button" class="btn btn-light active" data-filter="all">All</button>
                <button type="button" class="btn btn-light" data-filter="past-due">Past Due (2)</button>
                <button type="button" class="btn btn-light" data-filter="upcoming">Upcoming (5)</button>
                <button type="button" class="btn btn-light" data-filter="no-due">No Due (20)</button>
              </div>
              <button class="btn btn-sm btn-light" title="Refresh Data">
                <i class="bi bi-arrow-clockwise"></i>
              </button>
              <button class="btn btn-sm btn-light" title="Download Report">
                <i class="bi bi-download"></i>
              </button>
            </div>
          </div>
          <div class="table-container">
          <div class="table-responsive">
              <table id="shopStatusOverviewTable" class="table table-hover">
              <thead>
                <tr>
                    <th>Shop</th>
                    <th>Total SV</th>
                    <th>Past Due</th>
                    <th>Upcoming</th>
                    <th>No Due</th>
                    <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                      <div class="d-flex align-items-center gap-2">
                        <div class="shop-icon">
                          <i class="bi bi-shop"></i>
                        </div>
                        <div>
                          <div class="fw-medium">Shop1</div>
                          <div class="small text-muted">ID: SH001</div>
                        </div>
                      </div>
                    </td>
                    <td>
                      <div class="d-flex align-items-center gap-2">
                        <span class="fw-medium">27</span>
                        <span class="badge bg-success-subtle text-success small">+8.2%</span>
                    </div>
                  </td>
                    <td>
                      <div class="d-flex align-items-center gap-2">
                        <span class="badge bg-danger">2</span>
                        <span class="small text-danger">Urgent</span>
                      </div>
                    </td>
                    <td>
                      <div class="d-flex align-items-center gap-2">
                        <span class="badge bg-warning">5</span>
                        <span class="small text-warning">This Week</span>
                    </div>
                  </td>
                    <td>
                      <div class="d-flex align-items-center gap-2">
                        <span class="badge bg-success">20</span>
                        <span class="small text-success">On Track</span>
                    </div>
                  </td>
                    <td>
                      <div class="d-flex align-items-center gap-2">
                        <a href="shop.html" class="btn btn-sm btn-primary">View Details</a>
                        <div class="dropdown">
                          <button class="btn btn-sm btn-light" data-bs-toggle="dropdown">
                            <i class="bi bi-three-dots"></i>
                          </button>
                          <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-pencil me-2"></i>Edit</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-bell me-2"></i>Set Alert</a></li>
                            <li>
                              <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item text-danger" href="#"><i
                                  class="bi bi-exclamation-circle me-2"></i>Report Issue</a></li>
                          </ul>
                        </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            </div>
          </div>
          <div class="table-footer mt-3">
            <div class="d-flex justify-content-between align-items-center">
              <div class="table-info small text-muted">
                Showing <span class="fw-medium">1</span> of <span class="fw-medium">27</span> shops
              </div>
              <div class="table-actions">
                <button class="btn btn-sm btn-light" disabled>
                  <i class="bi bi-chevron-left"></i>
                </button>
                <button class="btn btn-sm btn-light">
                  <i class="bi bi-chevron-right"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Custom JS -->
  <script src="src/js/script.js"></script>

  <script>
    // DOM Ready
    $(document).ready(function () {
      // Sidebar Toggle
      $('.menu-toggle').on('click', function () {
        $('.sidebar').toggleClass('show');
      });

      // Close sidebar when clicking outside on mobile
      $(document).on('click', function (event) {
        const sidebar = $('.sidebar');
        const menuToggle = $('.menu-toggle');

        if (!sidebar.is(event.target) && sidebar.has(event.target).length === 0 &&
          !menuToggle.is(event.target) && menuToggle.has(event.target).length === 0) {
          sidebar.removeClass('show');
        }
      });

      // Initialize tooltips
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));

      // Initialize DataTables
      const shopTable = $('#shopStatusOverviewTable').DataTable({
        pageLength: 10,
        order: [[0, 'asc']],
        dom: '<"row"<"col-sm-12"tr>><"row"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7"p>>',
        language: {
          info: "Showing _START_ to _END_ of _TOTAL_ shops",
          paginate: {
            first: '<i class="bi bi-chevron-double-left"></i>',
            last: '<i class="bi bi-chevron-double-right"></i>',
            next: '<i class="bi bi-chevron-right"></i>',
            previous: '<i class="bi bi-chevron-left"></i>'
          }
        }
      });

      // Shop search functionality
      $('#shopSearch').on('keyup', function () {
        shopTable.search(this.value).draw();
      });

      // Filter functionality
      $('.table-filters .btn').on('click', function () {
        $('.table-filters .btn').removeClass('active');
        $(this).addClass('active');

        const filter = $(this).data('filter');
        if (filter === 'all') {
          shopTable.search('').draw();
        } else {
          shopTable.search(filter).draw();
        }
      });

      // Queue tab switching with animation
      $('.queue-tab').on('click', function () {
        $('.queue-tab').removeClass('active');
        $(this).addClass('active');

        $('.table-container').fadeOut(200, function () {
          $(this).fadeIn(200);
        });
      });

      // Initialize Charts
      initializeCharts();
    });

    // Charts Initialization
    function initializeCharts() {
      // Mini charts initialization
      const createMiniChart = (ctx, data, color) => {
        if (!ctx) return;
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: new Array(data.length).fill(''),
            datasets: [{
              data: data,
              borderColor: color,
              borderWidth: 2,
              tension: 0.4,
              pointRadius: 0,
              fill: true,
              backgroundColor: color + '10'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              x: { display: false },
              y: { display: false }
            }
          }
        });
      };

      // Initialize mini charts
      createMiniChart(document.getElementById('invoicesChart')?.getContext('2d'),
        [30, 35, 25, 45, 30, 55, 45],
        '#4f46e5'
      );
      createMiniChart(document.getElementById('pendingBillingChart')?.getContext('2d'),
        [25, 30, 35, 40, 35, 45, 40],
        '#f59e0b'
      );
      createMiniChart(document.getElementById('paidBillingChart')?.getContext('2d'),
        [45, 50, 40, 60, 45, 70, 60],
        '#10b981'
      );
      createMiniChart(document.getElementById('overdueBillingChart')?.getContext('2d'),
        [15, 20, 25, 15, 20, 10, 15],
        '#ef4444'
      );

      // Delay Reasons Analysis Chart
      const delayReasonsOverviewCtx = document.getElementById('delayReasonsOverviewChart')?.getContext('2d');
      if (delayReasonsOverviewCtx) {
        new Chart(delayReasonsOverviewCtx, {
          type: 'doughnut',
          data: {
            labels: ['Capacity', 'Customer', 'Volume', 'Other'],
            datasets: [{
              data: [45, 30, 14, 21],
              backgroundColor: [
                '#4f46e5',
                '#10b981',
                '#f59e0b',
                '#6b7280'
              ],
              borderWidth: 0,
              borderRadius: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '75%',
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                backgroundColor: 'white',
                titleColor: '#1e293b',
                bodyColor: '#1e293b',
                borderColor: '#e2e8f0',
                borderWidth: 1,
                padding: 8,
                boxPadding: 4,
                usePointStyle: true,
                callbacks: {
                  label: function (context) {
                    const value = context.raw;
                    const total = context.dataset.data.reduce((acc, val) => acc + val, 0);
                    const percentage = ((value / total) * 100).toFixed(1);
                    return `${context.label}: ${value} (${percentage}%)`;
                  }
                }
              }
            }
          }
        });
      }

      // Month over Month Timeliness Chart
      const timelinessOverviewCtx = document.getElementById('timelinessOverviewChart')?.getContext('2d');
      if (timelinessOverviewCtx) {
        new Chart(timelinessOverviewCtx, {
          type: 'line',
          data: {
            labels: [
              'Apr 22', 'May 22', 'Jun 22', 'Jul 22', 'Aug 22', 'Sep 22', 'Oct 22', 'Nov 22',
              'Feb 23', 'Mar 23', 'Apr 23', 'May 23', 'Jun 23', 'Jul 23', 'Aug 23', 'Sep 23',
              'Oct 23', 'Nov 23', 'Dec 23', 'Jan 24', 'Feb 24', 'Mar 24', 'Apr 24', 'May 24',
              'Jun 24', 'Jul 24', 'Aug 24', 'Sep 24', 'Oct 24', 'Nov 24'
            ],
            datasets: [{
              label: 'Monthly Value',
              data: [91, 23, 11, 9, 52, 12, 18, 6, 15, 8, 77, 4, 113, 17, 56, 26, 49, 30, 4, 64, 25, 97, 107, 62, 66, 86, 90, 105, 75, 50],
              borderColor: 'rgba(79, 70, 229, 1)',
              backgroundColor: 'rgba(79, 70, 229, 0.1)',
              tension: 0.4,
              fill: true,
              pointBackgroundColor: '#fff',
              pointBorderColor: 'rgba(79, 70, 229, 1)',
              pointBorderWidth: 2,
              pointRadius: 2,
              pointHoverRadius: 4,
              order: 2
            }, {
              label: '3-Month Moving Average',
              data: [null, 41.7, 14.3, 24, 24.3, 27.3, 12, 13, 9.7, 33.3, 29.7, 64.7, 44.7, 62, 33, 43.7, 35, 27.7, 32.7, 31, 62, 88.7, 88.7, 78.3, 71.3, 80.7, 93.7, 90, 76.7, null],
              borderColor: 'rgba(16, 185, 129, 1)',
              borderWidth: 2,
              borderDash: [4, 4],
              tension: 0.4,
              fill: false,
              pointRadius: 0,
              order: 1
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
              intersect: false,
              mode: 'index'
            },
            scales: {
              x: {
                grid: {
                  display: false
                },
                ticks: {
                  maxRotation: 45,
                  minRotation: 45,
                  font: {
                    size: 10
                  },
                  color: '#64748b',
                  maxTicksLimit: 12
                }
              },
              y: {
                grid: {
                  color: 'rgba(0, 0, 0, 0.05)',
                  drawBorder: false
                },
                border: {
                  dash: [4, 4]
                },
                beginAtZero: true,
                ticks: {
                  font: {
                    size: 10
                  },
                  color: '#64748b',
                  padding: 6,
                  maxTicksLimit: 6
                }
              }
            },
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                backgroundColor: 'white',
                titleColor: '#1e293b',
                bodyColor: '#1e293b',
                borderColor: '#e2e8f0',
                borderWidth: 1,
                padding: 8,
                boxPadding: 4,
                usePointStyle: true,
                titleFont: {
                  size: 11,
                  weight: '600'
                },
                bodyFont: {
                  size: 11
                },
                callbacks: {
                  label: function (context) {
                    let label = context.dataset.label || '';
                    if (label) {
                      label += ': ';
                    }
                    if (context.parsed.y !== null) {
                      label += context.parsed.y.toFixed(1);
                    }
                    return label;
                  }
                }
              }
            }
          }
        });
      }
    }
  </script>

  <style>
    /* Update border styles */
    :root {
      --border-color: rgba(0, 0, 0, 0.08);
      --border-radius-sm: 6px;
      --border-radius-md: 8px;
      --border-radius-lg: 12px;
      --border-radius-xl: 16px;
      --border-width: 1px;
      --border-width-thick: 2px;
      --card-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
      --hover-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    /* Card styles */
    .stat-card,
    .summary-card {
      background: var(--card-bg);
      border: var(--border-width) solid var(--border-color);
      border-radius: var(--border-radius-lg);
      padding: 1.25rem;
      box-shadow: var(--card-shadow);
      transition: all 0.2s ease;
    }

    .stat-card:hover,
    .summary-card:hover {
      box-shadow: var(--hover-shadow);
    }

    /* Chart container styles */
    .chart-container {
      background: var(--card-bg);
      border: var(--border-width) solid var(--border-color);
      border-radius: var(--border-radius-lg);
      padding: 1.25rem;
      box-shadow: var(--card-shadow);
    }

    .chart-header {
      border-bottom: var(--border-width) solid var(--border-color);
      padding-bottom: 1rem;
      margin-bottom: 1rem;
    }

    .chart-footer {
      border-top: var(--border-width) solid var(--border-color);
      padding-top: 1rem;
      margin-top: 1rem;
    }

    /* Table section styles */
    .table-section {
      background: var(--card-bg);
      border: var(--border-width) solid var(--border-color);
      border-radius: var(--border-radius-lg);
      padding: 1.25rem;
      box-shadow: var(--card-shadow);
    }

    .table-header {
      border-bottom: var(--border-width) solid var(--border-color);
      padding-bottom: 1rem;
      margin-bottom: 1rem;
    }

    .table-footer {
      border-top: var(--border-width) solid var(--border-color);
      padding-top: 1rem;
      margin-top: 1rem;
    }

    /* Table styles */
    .table {
      border-collapse: separate;
      border-spacing: 0;
    }

    .table> :not(caption)>*>* {
      border-bottom: var(--border-width) solid var(--border-color);
      padding: 0.75rem 1rem;
    }

    .table> :not(caption)>*:last-child>* {
      border-bottom: none;
    }

    /* Button styles */
    .btn {
      border-radius: var(--border-radius-sm);
      border-width: var(--border-width);
      transition: all 0.2s ease;
    }

    .btn:hover {
      box-shadow: var(--hover-shadow);
    }

    .btn-group .btn {
      border-radius: 0;
    }

    .btn-group .btn:first-child {
      border-top-left-radius: var(--border-radius-sm);
      border-bottom-left-radius: var(--border-radius-sm);
    }

    .btn-group .btn:last-child {
      border-top-right-radius: var(--border-radius-sm);
      border-bottom-right-radius: var(--border-radius-sm);
    }

    /* Input styles */
    .form-control,
    .form-select {
      border-radius: var(--border-radius-sm);
      border-width: var(--border-width);
    }

    .input-group .form-control,
    .input-group .form-select {
      border-radius: 0;
    }

    .input-group .form-control:first-child,
    .input-group .form-select:first-child {
      border-top-left-radius: var(--border-radius-sm);
      border-bottom-left-radius: var(--border-radius-sm);
    }

    .input-group .form-control:last-child,
    .input-group .form-select:last-child {
      border-top-right-radius: var(--border-radius-sm);
      border-bottom-right-radius: var(--border-radius-sm);
    }

    /* Badge styles */
    .badge {
      border-radius: var(--border-radius-sm);
      border: var(--border-width) solid transparent;
      padding: 0.375rem 0.75rem;
    }

    /* Icon styles */
    .shop-icon,
    .summary-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--border-radius-md);
      border: var(--border-width) solid transparent;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Chart action buttons */
    .chart-action-btn {
      width: 32px;
      height: 32px;
      border-radius: var(--border-radius-sm);
      border: var(--border-width) solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .chart-action-btn:hover {
      background: var(--background-color);
      box-shadow: var(--hover-shadow);
    }

    /* Delay stats styles */
    .delay-stats {
      border: var(--border-width) solid var(--border-color);
      border-radius: var(--border-radius-md);
      overflow: hidden;
    }

    .delay-item {
      border-bottom: var(--border-width) solid var(--border-color);
    }

    .delay-item:last-child {
      border-bottom: none;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {

      .stat-card,
      .summary-card,
      .chart-container,
      .table-section {
        border-radius: var(--border-radius-md);
        padding: 1rem;
      }

      .table> :not(caption)>*>* {
        padding: 0.625rem 0.75rem;
      }
    }

    /* Update font styles */
    :root {
      /* ... existing variables ... */

      /* Font sizes */
      --font-size-xs: 0.75rem;
      /* 12px */
      --font-size-sm: 0.875rem;
      /* 14px */
      --font-size-base: 1rem;
      /* 16px */
      --font-size-lg: 1.125rem;
      /* 18px */
      --font-size-xl: 1.25rem;
      /* 20px */
      --font-size-2xl: 1.5rem;
      /* 24px */

      /* Font weights */
      --font-weight-normal: 400;
      --font-weight-medium: 500;
      --font-weight-semibold: 600;
      --font-weight-bold: 700;

      /* Line heights */
      --line-height-tight: 1.25;
      --line-height-normal: 1.5;
      --line-height-relaxed: 1.75;
    }

    /* Base font styles */
    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
      font-size: var(--font-size-base);
      line-height: var(--line-height-normal);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Heading styles */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-weight: var(--font-weight-semibold);
      line-height: var(--line-height-tight);
      margin-bottom: 0.5rem;
    }

    h1 {
      font-size: var(--font-size-2xl);
    }

    h2 {
      font-size: var(--font-size-xl);
    }

    h3 {
      font-size: var(--font-size-lg);
    }

    h4 {
      font-size: var(--font-size-base);
    }

    /* Card text styles */
    .stat-title,
    .summary-label {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      color: var(--text-secondary);
    }

    .stat-value,
    .summary-value {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-semibold);
      color: var(--text-primary);
    }

    .stat-trend,
    .summary-trend {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
    }

    /* Table text styles */
    .table-title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
    }

    .table th {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-semibold);
      color: var(--text-secondary);
    }

    .table td {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-normal);
    }

    /* Button text styles */
    .btn {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
    }

    .btn-sm {
      font-size: var(--font-size-xs);
    }

    /* Badge text styles */
    .badge {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-medium);
      padding: 0.375rem 0.75rem;
    }

    /* Chart text styles */
    .chart-title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
    }

    .chart-legend {
      font-size: var(--font-size-sm);
    }

    .chart-insight {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-normal);
    }

    /* Small text styles */
    .small {
      font-size: var(--font-size-xs);
      line-height: var(--line-height-tight);
    }

    .text-muted {
      color: var(--text-secondary);
    }

    /* Responsive font adjustments */
    @media (max-width: 768px) {
      :root {
        --font-size-base: 0.9375rem;
        /* 15px */
        --font-size-lg: 1.0625rem;
        /* 17px */
        --font-size-xl: 1.1875rem;
        /* 19px */
        --font-size-2xl: 1.375rem;
        /* 22px */
      }

      .table th,
      .table td {
        font-size: var(--font-size-sm);
      }
    }
  </style>

  <script>
    // Load header component
    fetch('src/components/header.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('headerComponent').innerHTML = html;
        // Initialize header after loading
        initializeHeader();
      })
      .catch(error => console.error('Error loading header:', error));
  </script>
</body>

</html>